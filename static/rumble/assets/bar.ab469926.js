import{i as ye,s as be,c as H,a as Be,j as c,F as G,G as A,b as Oe,B as we,p as l,R as V,d as T,e as ke,Q as He,u as Ke,f as Se,g as Ge,r as je,l as qe,T as ie,h as ae,L as Qe,k as Ve,_ as Xe}from"./RumbleLoader.c6d6c914.js";import{A as Ue,G as Ye,a as Je}from"./Grid.be76391d.js";class oe extends Map{constructor(i,t=et){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),i!=null)for(const[r,n]of i)this.set(r,n)}get(i){return super.get(le(this,i))}has(i){return super.has(le(this,i))}set(i,t){return super.set(Ze(this,i),t)}delete(i){return super.delete(_e(this,i))}}function le({_intern:e,_key:i},t){const r=i(t);return e.has(r)?e.get(r):t}function Ze({_intern:e,_key:i},t){const r=i(t);return e.has(r)?e.get(r):(e.set(r,t),t)}function _e({_intern:e,_key:i},t){const r=i(t);return e.has(r)&&(t=e.get(r),e.delete(r)),t}function et(e){return e!==null&&typeof e=="object"?e.valueOf():e}function tt(e,i,t){e=+e,i=+i,t=(n=arguments.length)<2?(i=e,e=0,1):n<3?1:+t;for(var r=-1,n=Math.max(0,Math.ceil((i-e)/t))|0,a=new Array(n);++r<n;)a[r]=e+r*t;return a}const se=Symbol("implicit");function J(){var e=new oe,i=[],t=[],r=se;function n(a){let s=e.get(a);if(s===void 0){if(r!==se)return r;e.set(a,s=i.push(a)-1)}return t[s%t.length]}return n.domain=function(a){if(!arguments.length)return i.slice();i=[],e=new oe;for(const s of a)e.has(s)||e.set(s,i.push(s)-1);return n},n.range=function(a){return arguments.length?(t=Array.from(a),n):t.slice()},n.unknown=function(a){return arguments.length?(r=a,n):r},n.copy=function(){return J(i,t).unknown(r)},ye.apply(n,arguments),n}function Te(){var e=J().unknown(void 0),i=e.domain,t=e.range,r=0,n=1,a,s,o=!1,u=0,d=0,f=.5;delete e.unknown;function p(){var h=i().length,y=n<r,g=y?n:r,b=y?r:n;a=(b-g)/Math.max(1,h-u+d*2),o&&(a=Math.floor(a)),g+=(b-g-a*(h-u))*f,s=a*(1-u),o&&(g=Math.round(g),s=Math.round(s));var S=tt(h).map(function(O){return g+a*O});return t(y?S.reverse():S)}return e.domain=function(h){return arguments.length?(i(h),p()):i()},e.range=function(h){return arguments.length?([r,n]=h,r=+r,n=+n,p()):[r,n]},e.rangeRound=function(h){return[r,n]=h,r=+r,n=+n,o=!0,p()},e.bandwidth=function(){return s},e.step=function(){return a},e.round=function(h){return arguments.length?(o=!!h,p()):o},e.padding=function(h){return arguments.length?(u=Math.min(1,d=+h),p()):u},e.paddingInner=function(h){return arguments.length?(u=Math.min(1,h),p()):u},e.paddingOuter=function(h){return arguments.length?(d=+h,p()):d},e.align=function(h){return arguments.length?(f=Math.max(0,Math.min(1,h)),p()):f},e.copy=function(){return Te(i(),[r,n]).round(o).paddingInner(u).paddingOuter(d).align(f)},ye.apply(p(),arguments)}var nt=be("domain","range","reverse","align","padding","round");function rt(e){return nt(Te(),e)}var it=be("domain","range","reverse","unknown");function at(e){return it(J(),e)}var ce=Array.prototype.slice;function N(e,i){if((s=e.length)>1)for(var t=1,r,n,a=e[i[0]],s,o=a.length;t<s;++t)for(n=a,a=e[i[t]],r=0;r<o;++r)a[r][1]+=a[r][0]=isNaN(n[r][1])?n[r][0]:n[r][1]}function R(e){for(var i=e.length,t=new Array(i);--i>=0;)t[i]=i;return t}function ot(e,i){return e[i]}function lt(){var e=H([]),i=R,t=N,r=ot;function n(a){var s=e.apply(this,arguments),o,u=a.length,d=s.length,f=new Array(d),p;for(o=0;o<d;++o){for(var h=s[o],y=f[o]=new Array(u),g=0,b;g<u;++g)y[g]=b=[0,+r(a[g],h,g,a)],b.data=a[g];y.key=h}for(o=0,p=i(f);o<d;++o)f[p[o]].index=o;return t(f,p),f}return n.keys=function(a){return arguments.length?(e=typeof a=="function"?a:H(ce.call(a)),n):e},n.value=function(a){return arguments.length?(r=typeof a=="function"?a:H(+a),n):r},n.order=function(a){return arguments.length?(i=a==null?R:typeof a=="function"?a:H(ce.call(a)),n):i},n.offset=function(a){return arguments.length?(t=a==null?N:a,n):t},n}function st(e,i){if((r=e.length)>0){for(var t,r,n=0,a=e[0].length,s;n<a;++n){for(s=t=0;t<r;++t)s+=e[t][n][1]||0;if(s)for(t=0;t<r;++t)e[t][n][1]/=s}N(e,i)}}function ct(e,i){if((u=e.length)>0)for(var t,r=0,n,a,s,o,u,d=e[i[0]].length;r<d;++r)for(s=o=0,t=0;t<u;++t)(a=(n=e[i[t]][r])[1]-n[0])>0?(n[0]=s,n[1]=s+=a):a<0?(n[1]=o,n[0]=o+=a):(n[0]=0,n[1]=a)}function ut(e,i){if((n=e.length)>0){for(var t=0,r=e[i[0]],n,a=r.length;t<a;++t){for(var s=0,o=0;s<n;++s)o+=e[s][t][1]||0;r[t][1]+=r[t][0]=-o/2}N(e,i)}}function dt(e,i){if(!(!((s=e.length)>0)||!((a=(n=e[i[0]]).length)>0))){for(var t=0,r=1,n,a,s;r<a;++r){for(var o=0,u=0,d=0;o<s;++o){for(var f=e[i[o]],p=f[r][1]||0,h=f[r-1][1]||0,y=(p-h)/2,g=0;g<o;++g){var b=e[i[g]],S=b[r][1]||0,O=b[r-1][1]||0;y+=S-O}u+=p,d+=y*p}n[r-1][1]+=n[r-1][0]=t,u&&(t-=d/u)}n[r-1][1]+=n[r-1][0]=t,N(e,i)}}function pt(e){var i=e.map(ht);return R(e).sort(function(t,r){return i[t]-i[r]})}function ht(e){for(var i=-1,t=0,r=e.length,n,a=-1/0;++i<r;)(n=+e[i][1])>a&&(a=n,t=i);return t}function Me(e){var i=e.map($e);return R(e).sort(function(t,r){return i[t]-i[r]})}function $e(e){for(var i=0,t=-1,r=e.length,n;++t<r;)(n=+e[t][1])&&(i+=n);return i}function ft(e){return Me(e).reverse()}function gt(e){var i=e.length,t,r,n=e.map($e),a=pt(e),s=0,o=0,u=[],d=[];for(t=0;t<i;++t)r=a[t],s<o?(s+=n[r],u.push(r)):(o+=n[r],d.push(r));return d.reverse().concat(u)}function mt(e){return R(e).reverse()}var ue={ascending:Me,descending:ft,insideout:gt,none:R,reverse:mt};function xt(e){return e&&ue[e]||ue.none}var de={expand:st,diverging:ct,none:N,silhouette:ut,wiggle:dt};function vt(e){return e&&de[e]||de.none}function yt(e){if("bandwidth"in e)return e.bandwidth();var i=e.range(),t=e.domain();return Math.abs(i[i.length-1]-i[0])/t.length}function bt(e){return e==null?void 0:e[0]}function Ot(e){return e==null?void 0:e[1]}var wt=["data","className","top","left","x","y0","y1","xScale","yScale","color","keys","value","order","offset","children"];function kt(e,i){if(e==null)return{};var t={},r=Object.keys(e),n,a;for(a=0;a<r.length;a++)n=r[a],!(i.indexOf(n)>=0)&&(t[n]=e[n]);return t}function St(e){var i=e.data,t=e.className,r=e.top,n=e.left,a=e.x,s=e.y0,o=s===void 0?bt:s,u=e.y1,d=u===void 0?Ot:u,f=e.xScale,p=e.yScale,h=e.color,y=e.keys,g=e.value,b=e.order,S=e.offset,O=e.children,z=kt(e,wt),M=lt();y&&M.keys(y),g&&Be(M.value,g),b&&M.order(xt(b)),S&&M.offset(vt(S));var C=M(i),m=yt(f),x=C.map(function(v,k){var L=v.key;return{index:k,key:L,bars:v.map(function(w,$){var P=(p(o(w))||0)-(p(d(w))||0),W=p(d(w)),I="bandwidth"in f?f(a(w.data)):Math.max((f(a(w.data))||0)-m/2);return{bar:w,key:L,index:$,height:P,width:m,x:I||0,y:W||0,color:h(v.key,$)}})}});return O?c(G,{children:O(x)}):c(A,{className:Oe("visx-bar-stack",t),top:r,left:n,children:x.map(function(v){return v.bars.map(function(k){return c(we,{x:k.x,y:k.y,height:k.height,width:k.width,fill:k.color,...z},"bar-stack-"+v.index+"-"+k.index)})})})}var Tt=["flexDirection","alignItems","margin","display","children"];function Mt(e,i){if(e==null)return{};var t={},r=Object.keys(e),n,a;for(a=0;a<r.length;a++)n=r[a],!(i.indexOf(n)>=0)&&(t[n]=e[n]);return t}function Le(e){var i=e.flexDirection,t=i===void 0?"row":i,r=e.alignItems,n=r===void 0?"center":r,a=e.margin,s=a===void 0?"0":a,o=e.display,u=o===void 0?"flex":o,d=e.children,f=Mt(e,Tt);return c("div",{className:"visx-legend-item",style:{display:u,alignItems:n,flexDirection:t,margin:s},...f,children:d})}Le.propTypes={alignItems:l.exports.string,margin:l.exports.oneOfType([l.exports.string,l.exports.number]),children:l.exports.node,display:l.exports.string};var $t=["flex","label","margin","align","children"];function Lt(e,i){if(e==null)return{};var t={},r=Object.keys(e),n,a;for(a=0;a<r.length;a++)n=r[a],!(i.indexOf(n)>=0)&&(t[n]=e[n]);return t}function Ie(e){var i=e.flex,t=i===void 0?"1":i,r=e.label,n=e.margin,a=n===void 0?"5px 0":n,s=e.align,o=s===void 0?"left":s,u=e.children,d=Lt(e,$t);return c("div",{className:"visx-legend-label",style:{justifyContent:o,display:"flex",flex:t,margin:a},...d,children:u||r})}Ie.propTypes={align:l.exports.string,label:l.exports.node,flex:l.exports.oneOfType([l.exports.string,l.exports.number]),margin:l.exports.oneOfType([l.exports.string,l.exports.number]),children:l.exports.node};function U(){return U=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},U.apply(this,arguments)}function Z(e){var i=e.fill,t=e.width,r=e.height,n=e.style;return c("div",{style:U({width:t,height:r,background:i},n)})}Z.propTypes={fill:l.exports.string,width:l.exports.oneOfType([l.exports.string,l.exports.number]),height:l.exports.oneOfType([l.exports.string,l.exports.number])};function ze(e){var i=e.fill,t=e.width,r=e.height,n=e.style,a=typeof t=="string"||typeof t>"u"?0:t,s=typeof r=="string"||typeof r>"u"?0:r,o=Math.max(a,s),u=o/2;return c("svg",{width:o,height:o,children:c(A,{top:u,left:u,children:c("circle",{r:u,fill:i,style:n})})})}ze.propTypes={fill:l.exports.string,width:l.exports.oneOfType([l.exports.string,l.exports.number]),height:l.exports.oneOfType([l.exports.string,l.exports.number])};function Ce(e){var i=e.fill,t=e.width,r=e.height,n=e.style,a=typeof r=="string"||typeof r>"u"?0:r,s=typeof(n==null?void 0:n.strokeWidth)=="number"?n==null?void 0:n.strokeWidth:2;return c("svg",{width:t,height:r,children:c(A,{top:a/2-s/2,children:c("line",{x1:0,x2:t,y1:0,y2:0,stroke:i,strokeWidth:s,style:n})})})}Ce.propTypes={fill:l.exports.string,width:l.exports.oneOfType([l.exports.string,l.exports.number]),height:l.exports.oneOfType([l.exports.string,l.exports.number])};function B(){return B=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},B.apply(this,arguments)}var X=function(){};function It(e){var i=e.shape,t=i===void 0?"rect":i,r=e.fill,n=r===void 0?X:r,a=e.size,s=a===void 0?X:a,o=e.width,u=e.height,d=e.label,f=e.item,p=e.itemIndex,h=e.shapeStyle,y=h===void 0?X:h,g={width:o,height:u,item:f,itemIndex:p,label:d,fill:n(B({},d)),size:s(B({},d)),style:y(B({},d))};return typeof t=="string"?t==="circle"?c(ze,{...g}):t==="line"?c(Ce,{...g}):c(Z,{...g}):V.isValidElement(t)?V.cloneElement(t,g):t?V.createElement(t,g):null}function j(){return j=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},j.apply(this,arguments)}function Pe(e){var i=e.shape,t=i===void 0?Z:i,r=e.width,n=e.height,a=e.margin,s=e.label,o=e.item,u=e.itemIndex,d=e.fill,f=e.size,p=e.shapeStyle;return c("div",{className:"visx-legend-shape",style:{display:"flex",width:f?f(j({},s)):r,height:f?f(j({},s)):n,margin:a},children:It({shape:t,item:o,itemIndex:u,label:s,width:r,height:n,fill:d,shapeStyle:p})})}Pe.propTypes={itemIndex:l.exports.number.isRequired,margin:l.exports.oneOfType([l.exports.string,l.exports.number]),width:l.exports.oneOfType([l.exports.string,l.exports.number]),height:l.exports.oneOfType([l.exports.string,l.exports.number])};function De(e){return e&&typeof e=="object"&&"value"in e&&typeof e.value<"u"?e.value:e}function pe(e){return String(De(e))}function zt(e){var i=e.scale,t=e.labelFormat;return function(r,n){return{datum:r,index:n,text:""+t(r,n),value:i(r)}}}var Ct=["className","style","scale","shape","domain","fill","size","labelFormat","labelTransform","shapeWidth","shapeHeight","shapeMargin","shapeStyle","labelAlign","labelFlex","labelMargin","itemMargin","direction","itemDirection","legendLabelProps","children"];function Y(){return Y=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Y.apply(this,arguments)}function Pt(e,i){if(e==null)return{};var t={},r=Object.keys(e),n,a;for(a=0;a<r.length;a++)n=r[a],!(i.indexOf(n)>=0)&&(t[n]=e[n]);return t}var Dt={display:"flex"};function Fe(e){var i=e.className,t=e.style,r=t===void 0?Dt:t,n=e.scale,a=e.shape,s=e.domain,o=e.fill,u=o===void 0?pe:o,d=e.size,f=d===void 0?pe:d,p=e.labelFormat,h=p===void 0?De:p,y=e.labelTransform,g=y===void 0?zt:y,b=e.shapeWidth,S=b===void 0?15:b,O=e.shapeHeight,z=O===void 0?15:O,M=e.shapeMargin,C=M===void 0?"2px 4px 2px 0":M,m=e.shapeStyle,x=e.labelAlign,v=x===void 0?"left":x,k=e.labelFlex,L=k===void 0?"1":k,w=e.labelMargin,$=w===void 0?"0 4px":w,P=e.itemMargin,W=P===void 0?"0":P,I=e.direction,Ae=I===void 0?"column":I,ee=e.itemDirection,Ne=ee===void 0?"row":ee,Re=e.legendLabelProps,te=e.children,We=Pt(e,Ct),ne=s||("domain"in n?n.domain():[]),Ee=g({scale:n,labelFormat:h}),re=ne.map(Ee);return te?c(G,{children:te(re)}):c("div",{className:Oe("visx-legend",i),style:Y({},r,{flexDirection:Ae}),children:re.map(function(q,Q){return T(Le,{margin:W,flexDirection:Ne,...We,children:[c(Pe,{shape:a,height:z,width:S,margin:C,item:ne[Q],itemIndex:Q,label:q,fill:u,size:f,shapeStyle:m}),c(Ie,{label:q.text,flex:L,margin:$,align:v,...Re})]},"legend-"+q.text+"-"+Q)})})}Fe.propTypes={children:l.exports.func,className:l.exports.string,domain:l.exports.array,shapeWidth:l.exports.oneOfType([l.exports.string,l.exports.number]),shapeHeight:l.exports.oneOfType([l.exports.string,l.exports.number]),shapeMargin:l.exports.oneOfType([l.exports.string,l.exports.number]),labelAlign:l.exports.string,labelFlex:l.exports.oneOfType([l.exports.string,l.exports.number]),labelMargin:l.exports.oneOfType([l.exports.string,l.exports.number]),itemMargin:l.exports.oneOfType([l.exports.string,l.exports.number]),fill:l.exports.func,size:l.exports.func,shapeStyle:l.exports.func};function Ft(e){return c(Fe,{...e})}const At="#d5d8ea",Nt="#6c75c5",Rt="#6c5efb",Wt="#c998ff",he="#ff006f",Et="#eaedff",D="#a44afe",Bt="#808080",Ht={top:80,right:40,bottom:60,left:40},_=new URLSearchParams(window.location.search);var me;const F=(me=_.get("left"))!=null?me:"nginx:latest";var xe;const E=(xe=_.get("right"))!=null?xe:"dcgr.dev/chainguard/nginx:latest";var ve;const Kt=(ve=_.get("file"))!=null?ve:"fixed",fe={...ke,textAlign:"center",transform:"translateX(-50%)",fontSize:18},ge={...ke},K=["unknown","low","medium","high","critical"],Gt=e=>Se(e.date);function jt(e){return c(He,{keys:[F,E],file:Kt,children:i=>c(qt,{query:i,...e})})}function qt({width:e,height:i,query:{data:t,scanner:r},margin:n=Ht}){var M,C;const{tooltipOpen:a,tooltipLeft:s,tooltipData:o,hideTooltip:u,showTooltip:d}=Ke(),f=rt({domain:Object.values(t[F]).map(m=>Se(m.date)),padding:.1}),p=Ge({domain:[0,Math.max(...Object.values(t[F]).map(m=>m.totalCveCount),...Object.values(t[E]).map(m=>m.totalCveCount))+1],nice:!0}),h=at({domain:[...K],range:[At,Nt,Rt,Wt,he]}),y=je.exports.useCallback(m=>{var I;const x=f;let{x:v}=qe(m)||{x:0};v-=n.left,v>x.range()[1]&&(v-=x.range()[1],v-=S);const k=x.step(),L=x.domain(),w=(x.range()[1]-k*L.length)/2,$=x.domain()[Math.floor((v-w)/k)];if(!$)return;const P=t[F][$],W=t[E][$];d({tooltipData:{formattedDate:$,dataLeft:P,dataRight:W},tooltipLeft:((I=x($))!=null?I:0)+x.bandwidth()/2,tooltipTop:n.top})},[n,t]),g=e-n.left-n.right,b=i-n.top-n.bottom,S=20,O=(g-S)/2;if(f.range([0,O]),p.range([b,0]),e<10)return null;function z({data:m,tooltipData:x}){var v;return T(G,{children:[c(Ye,{xScale:f,yScale:p,width:O,height:b,stroke:"black",strokeOpacity:.1}),c(we,{width:O,height:b,fill:"transparent",onTouchStart:y,onTouchMove:y,onMouseMove:y,onMouseLeave:u}),c(St,{data:m,keys:[...K],x:Gt,xScale:f,yScale:p,color:h,children:k=>k.map(L=>L.bars.map(w=>c("rect",{x:w.x,y:w.y,height:w.height,width:w.width,fill:w.color,onMouseMove:y},`bar-stack-${L.index}-${w.index}`)))}),c(Je,{top:b,scale:f,stroke:D,tickStroke:D,numTicks:6,tickLabelProps:()=>({fill:D,fontSize:11,textAnchor:"middle"})}),a&&x&&T("g",{children:[c(Qe,{from:{x:s,y:0},to:{x:s,y:b},stroke:Bt,strokeWidth:2,pointerEvents:"none",strokeDasharray:"5,2"}),c("circle",{cx:s,cy:p((v=x.totalCveCount)!=null?v:0),r:6,fill:he,stroke:"white",strokeWidth:3,pointerEvents:"none"})]})]})}return T("div",{style:{position:"relative"},children:[T("svg",{width:e,height:i,onMouseLeave:u,children:[c("rect",{x:0,y:0,width:e,height:i,fill:Et,rx:14}),c(A,{top:n.top,left:n.left,children:c(z,{data:Object.values(t[F]),tooltipData:o==null?void 0:o.dataLeft})}),c(A,{top:n.top,left:n.left+O+S,children:c(z,{data:Object.values(t[E]),tooltipData:o==null?void 0:o.dataRight})}),c(A,{left:n.left,top:n.top,children:c(Ue,{scale:p,tickFormat:m=>m.toString(),stroke:D,tickStroke:D,tickLabelProps:()=>({fill:D,fontSize:11,textAnchor:"end",dx:"-0.5em",dy:"0.33em"})})})]}),a&&o&&T(G,{children:[o.dataLeft&&c(ie,{top:p((M=o.dataLeft.totalCveCount)!=null?M:0)+n.top,left:(s!=null?s:0)+12,style:ge,children:T("div",{style:{display:"flex",flexDirection:"column"},children:[c("div",{children:c("small",{children:o.formattedDate})}),T("div",{children:["Total: ",(C=o.dataLeft.totalCveCount)!=null?C:0]}),K.filter(m=>{var x,v;return((v=(x=o.dataLeft)==null?void 0:x[m])!=null?v:0)>0}).map(m=>{var x;return T("div",{style:{color:h(m)},children:[m,": ",(x=o.dataLeft)==null?void 0:x[m]]},m)})]})},Math.random()),o.dataRight&&c(ie,{top:p(o.dataRight.totalCveCount)+n.top,left:(s!=null?s:0)+S+O+12,style:ge,children:T("div",{style:{display:"flex",flexDirection:"column"},children:[c("div",{children:c("small",{children:o.formattedDate})}),T("div",{children:["Total: ",o.dataRight.totalCveCount]}),K.filter(m=>{var x,v;return((v=(x=o.dataRight)==null?void 0:x[m])!=null?v:0)>0}).map(m=>{var x;return T("div",{style:{color:h(m)},children:[m,": ",(x=o.dataRight)==null?void 0:x[m]]},m)})]})},Math.random())]}),c(ae,{top:n.top-25,left:n.left+O/2,style:fe,children:F.split("@")[0]}),c(ae,{top:n.top-25,left:n.left+S+O+O/2,style:fe,children:E.split("@")[0]}),T("div",{style:{position:"absolute",top:10,width:"100%",height:20,display:"flex",justifyContent:"center",fontSize:"16px",fontWeight:500,textAlign:"center",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:["Scanner: grype",r]}),c("div",{style:{position:"absolute",top:n.top/2,width:"100%",display:"flex",justifyContent:"center",fontSize:"14px"},children:c(Ft,{scale:h,direction:"row",legendLabelProps:{style:{textTransform:"capitalize",margin:"0 15px 0 0"}}})})]})}Ve.createRoot(document.getElementById("root")).render(c(Xe,{debounceTime:50,children:({width:e,height:i})=>c(jt,{width:e,height:i})}));
